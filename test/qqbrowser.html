<!DOCTYPE html>
<html>
<meta charset="utf-8" />

<style>
html,body {
    margin: 0;
    padding: 0;
    position: absolute;
    overflow: hidden;
    width: 100%;
    height: 100%;
    background: #333;
}
.sun, .star {
    position: absolute;
}
.sun {
    width: 80px;
    height: 80px;
    left: 50%;
    top: 50%;
    margin-left: -40px;
    margin-top: -40px;
    -webkit-border-radius: 80px;
    background: #3C97F9;
    -webkit-box-shadow: 0 0 20px #2ABBFF;
}
.star {
    left: 50%;
    top: 50%;
    width: 2px;
    height: 2px;
    font-size: 0;
    overflow: hidden;
    background: yellow;
    -webkit-border-radius: 2px;
    -webkit-box-shadow: 0 0 4px yellow;
}
</style>

<div class="sun"></div>
<script>
var $ = $ || {};
window.requestAnimFrame = (function() {
  				return window.requestAnimationFrame ||
    			window.webkitRequestAnimationFrame ||
     			window.mozRequestAnimationFrame ||
     			window.oRequestAnimationFrame ||
     			window.msRequestAnimationFrame ||
     			function(/* function FrameRequestCallback */ callback, /* DOMElement Element */ element) {
       				window.setTimeout(callback, 1000/60);
     			};
			})();
            
$.Class = function () {
    var context = this,
    old = context.Class,
    f = 'function',
    fnTest = /xyz/.test(function() {
        xyz
    }) ? /\bsupr\b/: /.*/,
    proto = 'prototype';
 
    function Class(o) {
        return extend.call(isFn(o) ? o: function() {},
        o, 1)
    }
 
    function isFn(o) {
        return typeof o === f
    }
 
    function wrap(k, fn, supr) {
        return function() {
            var tmp = this.supr
            this.supr = supr[proto][k]
            var ret = fn.apply(this, arguments)
            this.supr = tmp
            return ret
        }
    }
 
    function process(what, o, supr) {
        for (var k in o) {
            if (o.hasOwnProperty(k)) {
                what[k] = isFn(o[k]) && isFn(supr[proto][k]) && fnTest.test(o[k]) ? wrap(k, o[k], supr) : o[k]
            }
        }
    }
 
    function extend(o, fromSub) {
        // must redefine noop each time so it doesn't inherit from previous arbitrary classes
        function noop() {}
        noop[proto] = this[proto]
        var supr = this,
        prototype = new noop(),
        isFunction = isFn(o),
        _constructor = isFunction ? o: this,
        _methods = isFunction ? {}: o
        function fn() {
            if (this.initialize) this.initialize.apply(this, arguments)
            else {
                fromSub || isFunction && supr.apply(this, arguments)
                _constructor.apply(this, arguments)
            }
        }
 
        fn.methods = function(o) {
            process(prototype, o, supr)
            fn[proto] = prototype
            return this
        }
 
        fn.methods.call(fn, _methods).prototype.constructor = fn
 
        fn.extend = arguments.callee
        fn[proto].implement = fn.statics = function(o, optFn) {
            o = typeof o == 'string' ? (function() {
                var obj = {}
                obj[o] = optFn
                return obj
            } ()) : o
            process(this, o, supr)
            return this
        }
 
        return fn
    }
    
    return Class;  
}();

$.Loop = $.Class(function (callback, that) {
        var keepUpdating = true,
            lastLoopTime = new Date();
            
        function loop () {
            if (!keepUpdating) { return }
            requestAnimFrame(loop);
            
            var time = new Date(),
                dt = (time - lastLoopTime) / 1000;

            if (dt >= 3) {
                dt = 0.25;
            }
            
            callback.call(that, dt);
            lastLoopTime = time;
        }
        
        // stop
        this.stop = function () {
            keepUpdating = false;
        }
        
        // resume
        this.resume = function () {
            keepUpdating = true;
            lastLoopTime = new Date();
            loop();
        }
        
        loop();
        return this;
    });
 
// namespace
$.NS = function (name, fn) {
    var names = name.split('.'),
        i = -1,
        loopName = window;
    if (names[0] == '') {
        names[0] = '$';
    }
    
    while (names[++ i]) {
        var na = names[i];
        if (loopName[na] ===  undefined) {
            loopName[na] = {};
        }
        loopName = loopName[na];
    }
    !!fn && fn.call(loopName, $);
};

$.extend = $.extend || function (target, source, isOverwrite) {
    if (isOverwrite == undefined) { isOverwrite = true }
    for (var k in source) {
        if (!(k in target) || isOverwrite) {
            target[k] = source[k];
        }
    }
    return target;
}


// Main Func
$.NS('SunSys', function ($) {
    
    var Star = $.Class(function (opt) {
        var defaults = {
            longAxis: 200,
            shortAxis: 60,
            angle: 20,
            speed: 2,
            startX: (100 - Math.random()*200)
        };
        opt = $.extend(defaults, opt);
        this.opt = opt;
        
        this._x = this.opt.startX; // 未旋转前的x
        this._y = 0; // 未旋转的y
        // 有角度的实际的xy
        this.x = 0; 
        this.y = 0;
        
    }).methods({
        getXY: 
        update: function (dt) {
            
        }
    })
    
})
</script>
</html>